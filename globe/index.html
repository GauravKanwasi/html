<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<title>Interactive Earth ‚Äì Time-Zones</title>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<style>
  *{margin:0;padding:0;box-sizing:border-box;font-family:system-ui,Arial,sans-serif}
  body{background:#000;color:#fff;overflow:hidden}
  #container{position:absolute;top:0;left:0;width:100%;height:100%}
  #ui{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,.7);padding:8px 14px;border-radius:20px;font-size:14px}
  #tzBtn{position:absolute;top:20px;right:20px;width:48px;height:48px;border-radius:50%;border:none;background:rgba(255,255,255,.15);color:#fff;font-size:24px;cursor:pointer;backdrop-filter:blur(4px)}
  #tzSheet{position:fixed;bottom:0;left:0;width:100%;max-height:0;background:#111;overflow:hidden;transition:max-height .3s;border-top:1px solid #333;border-radius:20px 20px 0 0}
  #tzSheet.open{max-height:60vh}
  #sheetHeader{padding:14px 18px;border-bottom:1px solid #333;display:flex;align-items:center}
  #sheetHeader span{flex:1;font-weight:600}
  #closeSheet{background:none;border:none;color:#fff;font-size:20px;cursor:pointer}
  #sheetSearch{background:#222;border:none;color:#fff;width:100%;padding:10px 18px;font-size:15px;outline:none}
  #sheetList{max-height:calc(60vh - 110px);overflow-y:auto}
  .sheetRow{padding:12px 18px;display:flex;align-items:center;font-size:15px}
  .sheetRow:not(:last-child){border-bottom:1px solid #222}
  .sheetRow input{margin-right:12px;width:18px;height:18px}
</style>
</head>
<body>
<div id="container"></div>
<div id="ui">Drag to rotate ‚Ä¢ Scroll to zoom ‚Ä¢ Showing <span id="count">0</span> zones</div>
<button id="tzBtn">üåç</button>

<div id="tzSheet">
  <div id="sheetHeader">
    <span>Time Zones</span>
    <button id="closeSheet">‚úï</button>
  </div>
  <input id="sheetSearch" placeholder="Search zone‚Ä¶"/>
  <div id="sheetList"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
<script>
// Scene setup
const scene=new THREE.Scene(),camera=new THREE.PerspectiveCamera(45,innerWidth/innerHeight,.1,1000);
const renderer=new THREE.WebGLRenderer({antialias:true,alpha:true});
renderer.setSize(innerWidth,innerHeight);
document.body.appendChild(renderer.domElement);

scene.add(new THREE.AmbientLight(0xffffff,.4));
const light=new THREE.DirectionalLight(0xffffff,1);light.position.set(5,3,5);scene.add(light);

const radius=5;
const earth=new THREE.Mesh(
  new THREE.SphereGeometry(radius,64,64),
  new THREE.MeshPhongMaterial({
    map:new THREE.TextureLoader().load('https://cdn.jsdelivr.net/npm/three-globe/example/img/earth-blue-marble.jpg'),
    bumpMap:new THREE.TextureLoader().load('https://cdn.jsdelivr.net/npm/three-globe/example/img/earth-topology.png'),
    bumpScale:0.05
  })
);scene.add(earth);

const clouds=new THREE.Mesh(
  new THREE.SphereGeometry(radius+.03,64,64),
  new THREE.MeshPhongMaterial({
    map:new THREE.TextureLoader().load('https://cdn.jsdelivr.net/npm/three-globe/example/img/earth-clouds.png'),
    transparent:true,opacity:.4
  })
);scene.add(clouds);

// Time-zone markers (15¬∞ steps)
const zones=[];
for(let lon=-180;lon<180;lon+=15)zones.push({name:`UTC${lon?lon/15:''}`,lat:0,lon});
const markerGroup=new THREE.Group();scene.add(markerGroup);
const latLonToVector3=(lat,lon,r)=>new THREE.Vector3(
  -r*Math.cos(lat*Math.PI/180)*Math.cos(lon*Math.PI/180),
  r*Math.sin(lat*Math.PI/180),
  r*Math.cos(lat*Math.PI/180)*Math.sin(lon*Math.PI/180)
);
zones.forEach(z=>{
  const sp=new THREE.Sprite(new THREE.SpriteMaterial({
    map:new THREE.TextureLoader().load('data:image/svg+xml;base64,'+btoa('<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8"><circle cx="4" cy="4" r="3" fill="#fff" fill-opacity="0.55"/></svg>')),
    transparent:true,opacity:.7,depthTest:false
  }));
  sp.position.copy(latLonToVector3(z.lat,z.lon,radius+.05));
  sp.scale.set(.15,.15,1);
  sp.userData=z;
  markerGroup.add(sp);
});

// UI
let selected=new Set();zones.forEach((_,i)=>selected.add(i));
const countSpan=document.getElementById('count');
const sheet=document.getElementById('tzSheet');
const searchBox=document.getElementById('sheetSearch');
const sheetList=document.getElementById('sheetList');

function buildList(f=''){
  sheetList.innerHTML='';
  zones.forEach((z,i)=>{
    if(!z.name.toLowerCase().includes(f.toLowerCase()))return;
    const row=document.createElement('label');row.className='sheetRow';
    const cb=document.createElement('input');cb.type='checkbox';cb.checked=selected.has(i);
    cb.addEventListener('change',()=>toggleZone(i));
    row.appendChild(cb);row.append(' '+z.name);
    row.addEventListener('click',e=>{if(e.target!==cb){cb.checked=!cb.checked;toggleZone(i);}});
    sheetList.appendChild(row);
  });
}
function toggleZone(i){
  if(selected.has(i)){selected.delete(i);markerGroup.children[i].visible=false;}
  else{selected.add(i);markerGroup.children[i].visible=true;}
  buildList(searchBox.value);countSpan.textContent=selected.size;
}
buildList();countSpan.textContent=zones.length;

document.getElementById('tzBtn').addEventListener('click',()=>{sheet.classList.add('open');buildList();});
document.getElementById('closeSheet').addEventListener('click',()=>sheet.classList.remove('open'));
searchBox.addEventListener('input',e=>buildList(e.target.value));

// Controls
let rot={x:0,y:0},tgt={x:0,y:0},drag=false,last={x:0,y:0};
renderer.domElement.addEventListener('mousedown',e=>{drag=true;last={x:e.clientX,y:e.clientY}});
document.addEventListener('mousemove',e=>{
  if(!drag)return;
  tgt.y+=(e.clientX-last.x)*0.005;
  tgt.x-=(e.clientY-last.y)*0.005;
  tgt.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,tgt.x));
  last={x:e.clientX,y:e.clientY};
});
document.addEventListener('mouseup',()=>drag=false);
renderer.domElement.addEventListener('wheel',e=>{
  camera.position.z+=e.deltaY*0.01;
  camera.position.z=Math.max(8,Math.min(20,camera.position.z));
});

camera.position.z=12;
function animate(){
  requestAnimationFrame(animate);
  rot.x+=(tgt.x-rot.x)*.05;
  rot.y+=(tgt.y-rot.y)*.05;
  earth.rotation.x=clouds.rotation.x=rot.x;
  earth.rotation.y=clouds.rotation.y=rot.y;
  markerGroup.rotation.x=rot.x;
  markerGroup.rotation.y=rot.y;
  if(!drag)tgt.y+=0.0003;
  clouds.rotation.y+=0.0002;
  renderer.render(scene,camera);
}
animate();

window.addEventListener('resize',()=>{
  camera.aspect=innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
});
</script>
</body>
</html>
